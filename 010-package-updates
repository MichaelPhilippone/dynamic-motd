#!/bin/bash
# Available package updates (highlight security updates)

# Check if apt cache needs update
apt_cache_file="/var/cache/apt/pkgcache.bin"
if [[ -f "$apt_cache_file" ]]; then
    cache_age=$(($(date +%s) - $(stat -c %Y "$apt_cache_file")))
    # If cache is older than 24 hours, update it
    if [[ $cache_age -gt 86400 ]]; then
        apt-get update &>/dev/null
    fi
fi

# Get available upgrades
total=$(apt list --upgradable 2>/dev/null | wc -l)

if [[ $total -eq 0 ]]; then
    printf "\033[1;32mâœ“ System is up to date\033[0m\n"
else
    # Try to detect security updates (simple heuristic)
    security_count=$(apt list --upgradable 2>/dev/null | grep -i "security\|ubuntu-.*-security" | wc -l)
    
    printf "\033[1mðŸ“¦ Package Updates:\033[0m\n"
    printf "  Total updates: %d\n" "$((total - 1))"
    
    if [[ $security_count -gt 0 ]]; then
        printf "  \033[1;31mâš  Security updates: %d\033[0m\n" "$security_count"
    fi
fi
